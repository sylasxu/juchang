<!--
  AI è¾“å…¥æ ç»„ä»¶
  Requirements: 2.1, 2.2, 2.5
  
  ä½ç½®ï¼šTabbarä¸Šæ–¹æ‚¬æµ®
  å¤–è§‚ï¼šç±»ä¼¼çµåŠ¨å²›çš„é»‘è‰²é•¿æ¡
-->
<view class="ai-input-bar {{isExpanded ? 'expanded' : ''}}">
  <!-- æ”¶èµ·çŠ¶æ€ï¼šç‚¹å‡»å±•å¼€ -->
  <view wx:if="{{!isExpanded}}" class="bar-collapsed" bindtap="onBarTap">
    <view class="ai-icon">
      <text>ðŸ¤–</text>
    </view>
    <view class="flex-1 text-sm text-white opacity-60 truncate">{{placeholder}}</view>
    <view class="voice-btn" catchtap="onVoiceTap">
      <t-icon name="sound" size="40rpx" color="#fff" />
    </view>
  </view>

  <!-- å±•å¼€çŠ¶æ€ï¼šè¾“å…¥æ¡† -->
  <view wx:else class="bar-expanded">
    <view class="ai-icon">
      <text>ðŸ¤–</text>
    </view>
    
    <view class="input-wrapper">
      <input
        class="flex-1 h-full text-sm text-white"
        type="text"
        placeholder="{{placeholder}}"
        placeholder-class="text-white opacity-40"
        value="{{inputValue}}"
        focus="{{isExpanded}}"
        confirm-type="send"
        bindinput="onInputChange"
        bindfocus="onInputFocus"
        bindblur="onInputBlur"
        bindconfirm="onInputConfirm"
      />
      
      <!-- æ¸…ç©ºæŒ‰é’® -->
      <view wx:if="{{inputValue}}" class="flex items-center justify-center flex-shrink-0" style="width: 48rpx; height: 48rpx;" catchtap="onClearTap">
        <t-icon name="close-circle-filled" size="36rpx" color="#999" />
      </view>
    </view>

    <!-- è¯­éŸ³/å‘é€æŒ‰é’® -->
    <view class="action-btn" catchtap="{{inputValue ? 'onInputConfirm' : 'onVoiceTap'}}">
      <view wx:if="{{isRecording}}" class="flex flex-col items-center justify-center">
        <view class="recording-dot"></view>
        <text class="text-xs text-white mt-1">{{recordingDuration}}s</text>
      </view>
      <t-icon wx:elif="{{inputValue}}" name="send" size="44rpx" color="#fff" />
      <t-icon wx:else name="sound" size="44rpx" color="#fff" />
    </view>
  </view>
</view>
