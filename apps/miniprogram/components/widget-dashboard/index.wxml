<!--
  Widget Dashboard 组件
  v4.4 重构: 增加社交档案卡片和快捷入口
  
  进场欢迎卡片
  - 动态问候语（API 返回）
  - 社交档案卡片（参与/发起统计 + 偏好完善引导）
  - 快捷入口（预设 Prompt）
  - 分组快捷操作（draft/suggestions/explore）
  - 待参加活动列表（最多 3 个）
-->
<view class="widget-dashboard halo-card">
  <!-- 问候语区域 -->
  <view class="dashboard-header">
    <view class="greeting-icon icon-circle icon-circle--blue">
      <t-icon name="sunny" size="40rpx" />
    </view>
    <view class="greeting-content">
      <text class="greeting-text">{{greeting}}</text>
      <text wx:if="{{subGreeting}}" class="sub-greeting-text">{{subGreeting}}</text>
    </view>
  </view>
  
  <!-- v4.4: 社交档案卡片 -->
  <block wx:if="{{hasSocialProfile}}">
    <social-profile-card 
      profile="{{socialProfile}}"
      collapsed="{{hasActivities}}"
    />
  </block>
  
  <!-- v4.4: 快捷入口 -->
  <block wx:if="{{hasQuickPrompts && !hasActivities}}">
    <view class="quick-prompts-section">
      <quick-prompts 
        prompts="{{quickPrompts}}"
        bind:prompttap="onQuickPromptTap"
      />
    </view>
  </block>
  
  <!-- v3.10: 分组快捷操作 -->
  <block wx:if="{{hasSections && !hasQuickPrompts}}">
    <view class="sections-container">
      <view 
        wx:for="{{sections}}" 
        wx:key="id"
        class="section-group"
      >
        <view class="section-group-header">
          <text class="section-group-icon">{{item.icon}}</text>
          <text class="section-group-title">{{item.title}}</text>
        </view>
        <view class="section-group-items">
          <view 
            wx:for="{{item.items}}" 
            wx:for-item="quickItem"
            wx:key="label"
            class="quick-item quick-item--{{quickItem.type}} btn-pressable"
            data-item="{{quickItem}}"
            bindtap="onQuickItemTap"
          >
            <text wx:if="{{quickItem.icon}}" class="quick-item-icon">{{quickItem.icon}}</text>
            <text class="quick-item-label">{{quickItem.label}}</text>
          </view>
        </view>
      </view>
    </view>
  </block>
  
  <!-- 有活动时显示活动列表 -->
  <block wx:if="{{hasActivities}}">
    <view class="dashboard-section">
      <view class="section-header">
        <text class="section-title">待参加的活动</text>
        <view class="section-action" bindtap="onViewAllTap">
          <text class="action-text">查看全部</text>
          <t-icon name="chevron-right" size="28rpx" />
        </view>
      </view>
      
      <!-- 活动列表 -->
      <view class="activity-list">
        <view 
          wx:for="{{displayActivities}}" 
          wx:key="id"
          class="activity-item"
          data-id="{{item.id}}"
          bindtap="onActivityTap"
        >
          <activity-mini-card 
            activity="{{item}}"
            bind:tap="onActivityTap"
          />
        </view>
      </view>
    </view>
  </block>
  
  <!-- 无分组、无快捷入口且无活动时显示引导 -->
  <block wx:if="{{!hasSections && !hasQuickPrompts && !hasActivities && !hasSocialProfile}}">
    <view class="dashboard-empty">
      <view class="empty-icon">
        <t-icon name="chat" size="64rpx" color="#5B75FB" />
      </view>
      <text class="empty-text">最近没局？有些朋友可能在等你开口。</text>
    </view>
  </block>
</view>
