<t-navbar left-arrow title="个人信息" />

<t-loading wx:if="{{isLoading}}" text="加载中..." />

<view wx:else class="info-edit">
  <!-- 头像 -->
  <t-cell class="info-edit__cell" title="头像" arrow bindtap="onChooseAvatar">
    <t-avatar 
      slot="note" 
      image="{{userInfo.avatarUrl}}" 
      icon="user" 
      size="large"
    />
  </t-cell>

  <!-- 昵称 -->
  <t-cell class="info-edit__cell" title="昵称">
    <t-input 
      bind:change="onNicknameChange" 
      borderless 
      placeholder="请输入昵称" 
      slot="note" 
      value="{{userInfo.nickname}}"
      maxlength="20"
    />
  </t-cell>

  <!-- 性别 -->
  <t-cell class="info-edit__cell" title="性别">
    <t-radio-group
      bind:change="onGenderChange"
      borderless
      options="{{genderOptions}}"
      slot="note"
      t-class="info-edit__gender"
      value="{{userInfo.gender}}"
    />
  </t-cell>

  <!-- 个人简介 -->
  <t-cell class="info-edit__cell" title="个人简介">
    <t-textarea
      bind:change="onBioChange"
      disableDefaultPadding="{{true}}"
      indicator
      maxlength="100"
      placeholder="介绍一下自己吧"
      slot="note"
      t-class="info-edit__bio"
      value="{{userInfo.bio}}"
    />
  </t-cell>
</view>

<view class="info-edit__save">
  <t-button 
    bind:tap="onSaveInfo" 
    block 
    size="large" 
    theme="primary"
    loading="{{isSaving}}"
    disabled="{{isSaving}}"
  >
    {{isSaving ? '保存中...' : '保存'}}
  </t-button>
</view>

<t-date-time-picker
  auto-close
  bind:cancel="hidePicker"
  bind:change="onPickerChange"
  cancelBtn="取消"
  confirmBtn="确认"
  data-mode="birth"
  defaultValue="{{personInfo.birth}}"
  end="{{birthEnd}}"
  filter="{{birthFilter}}"
  format="YYYY-MM-DD"
  mode="date"
  popup-props="{{ { usingCustomNavbar: true } }}"
  start="{{birthStart}}"
  title="选择生日"
  value="{{personInfo.birth}}"
  visible="{{birthVisible}}"
/>

<t-picker
  bind:cancel="hidePicker"
  bind:change="onPickerChange"
  bind:close="hidePicker"
  bind:pick="onAreaPick"
  cancelBtn="取消"
  confirmBtn="确认"
  data-mode="address"
  mode="address"
  title="选择地址"
  value="{{personInfo.address}}"
  visible="{{addressVisible}}"
>
  <t-picker-item options="{{provinces}}" />
  <t-picker-item options="{{cities}}" />
</t-picker>
