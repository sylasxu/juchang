<view class="search-page">
  <!-- æœç´¢æ¡† -->
  <view class="search-header">
    <t-search
      value="{{searchValue}}"
      placeholder="æœç´¢æ´»åŠ¨"
      shape="round"
      action="å–æ¶ˆ"
      bind:submit="handleSubmit"
      bind:action-click="handleCancel"
      focus
    />
  </view>

  <!-- æœç´¢ç»“æœ -->
  <view wx:if="{{hasSearched}}" class="search-results">
    <t-loading wx:if="{{loading}}" theme="circular" size="40rpx" text="æœç´¢ä¸­..." />
    
    <view wx:elif="{{searchResults.length === 0}}" class="empty-result">
      <t-empty icon="search" description="æœªæ‰¾åˆ°ç›¸å…³æ´»åŠ¨" />
    </view>
    
    <view wx:else class="result-list">
      <view 
        wx:for="{{searchResults}}" 
        wx:key="id" 
        class="result-item"
        data-id="{{item.id}}"
        bind:tap="handleResultTap"
      >
        <view class="result-title">{{item.title}}</view>
        <view class="result-info">
          <text class="result-location">ğŸ“ {{item.locationName}}</text>
          <text class="result-distance" wx:if="{{item.distance}}">{{item.distance < 1000 ? item.distance + 'm' : (item.distance / 1000).toFixed(1) + 'km'}}</text>
        </view>
        <view class="result-meta">
          <text class="result-time">ğŸ• {{item.startAt}}</text>
          <text class="result-participants">ğŸ‘¥ {{item.currentParticipants}}/{{item.maxParticipants}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å†å²è®°å½•å’Œçƒ­é—¨æœç´¢ -->
  <view wx:else class="search-suggestions">
    <!-- å†å²è®°å½• -->
    <view wx:if="{{historyWords.length > 0}}" class="history-section">
      <view class="section-header">
        <text class="section-title">æœç´¢å†å²</text>
        <t-icon name="delete" size="40rpx" bind:tap="handleClearHistory" />
      </view>
      <view class="tag-list">
        <view 
          wx:for="{{historyWords}}" 
          wx:key="*this" 
          class="tag-item"
          data-index="{{index}}"
          bind:tap="handleHistoryTap"
          bindlongpress="deleteHistory"
        >
          <t-tag variant="light">{{item}}</t-tag>
        </view>
      </view>
    </view>

    <!-- çƒ­é—¨æœç´¢ -->
    <view class="popular-section">
      <view class="section-header">
        <text class="section-title">çƒ­é—¨æœç´¢</text>
      </view>
      <view class="tag-list">
        <view 
          wx:for="{{popularWords}}" 
          wx:key="*this" 
          class="tag-item"
          data-index="{{index}}"
          bind:tap="handlePopularTap"
        >
          <t-tag variant="light" icon="search">{{item}}</t-tag>
        </view>
      </view>
    </view>
  </view>
</view>
