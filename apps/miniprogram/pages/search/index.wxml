<!--
  æœç´¢é¡µé¢
  TDesign + Atomic Less é‡æ„
-->
<view class="min-h-screen bg-gray-50">
  <!-- æœç´¢æ¡† -->
  <view class="p-3 bg-white">
    <t-search
      value="{{searchValue}}"
      placeholder="æœç´¢æ´»åŠ¨"
      shape="round"
      action="å–æ¶ˆ"
      bind:submit="handleSubmit"
      bind:action-click="handleCancel"
      focus
    />
  </view>

  <!-- æœç´¢ç»“æœ -->
  <view wx:if="{{hasSearched}}" class="p-3">
    <view wx:if="{{loading}}" class="flex justify-center py-12">
      <t-loading theme="circular" size="40rpx" text="æœç´¢ä¸­..." />
    </view>
    
    <view wx:elif="{{searchResults.length === 0}}" class="py-12 text-center">
      <t-empty icon="search" description="æœªæ‰¾åˆ°ç›¸å…³æ´»åŠ¨" />
    </view>
    
    <view wx:else class="bg-white rounded-lg overflow-hidden">
      <view 
        wx:for="{{searchResults}}" 
        wx:key="id" 
        class="result-item px-3 py-3 border-b border-gray-100"
        data-id="{{item.id}}"
        bind:tap="handleResultTap"
      >
        <view class="text-lg font-medium text-gray-900 mb-2">{{item.title}}</view>
        <view class="flex justify-between items-center mb-1">
          <text class="text-sm text-gray-600">ğŸ“ {{item.locationName}}</text>
          <text class="text-xs text-gray-400" wx:if="{{item.distance}}">
            {{item.distance < 1000 ? item.distance + 'm' : (item.distance / 1000).toFixed(1) + 'km'}}
          </text>
        </view>
        <view class="flex gap-3 text-xs text-gray-400">
          <text>ğŸ• {{item.startAt}}</text>
          <text>ğŸ‘¥ {{item.currentParticipants}}/{{item.maxParticipants}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å†å²è®°å½•å’Œçƒ­é—¨æœç´¢ -->
  <view wx:else class="p-3">
    <!-- å†å²è®°å½• -->
    <view wx:if="{{historyWords.length > 0}}" class="bg-white rounded-lg p-3 mb-3">
      <view class="flex justify-between items-center mb-3">
        <text class="text-sm font-medium text-gray-900">æœç´¢å†å²</text>
        <t-icon name="delete" size="40rpx" color="#9CA3AF" bind:tap="handleClearHistory" />
      </view>
      <view class="flex flex-wrap gap-2">
        <view 
          wx:for="{{historyWords}}" 
          wx:key="*this" 
          data-index="{{index}}"
          bind:tap="handleHistoryTap"
          bindlongpress="deleteHistory"
        >
          <t-tag variant="light">{{item}}</t-tag>
        </view>
      </view>
    </view>

    <!-- çƒ­é—¨æœç´¢ -->
    <view class="bg-white rounded-lg p-3">
      <view class="flex justify-between items-center mb-3">
        <text class="text-sm font-medium text-gray-900">çƒ­é—¨æœç´¢</text>
      </view>
      <view class="flex flex-wrap gap-2">
        <view 
          wx:for="{{popularWords}}" 
          wx:key="*this" 
          data-index="{{index}}"
          bind:tap="handlePopularTap"
        >
          <t-tag variant="light" icon="search">{{item}}</t-tag>
        </view>
      </view>
    </view>
  </view>
</view>
