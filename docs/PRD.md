# 聚场 (JuChang) 产品需求文档 - Lean MVP

> **版本**：v3.0 (纯工具版)
> **更新日期**：2024-12
> **核心定位**：微信群组局神器 —— 把群聊里的"流"，变成地图上的"桩"

---

## 0. 产品定位与核心价值

### 0.1 我们解决什么问题？

**核心矛盾**：用户想组局/找搭子，但微信群存在"信息流失"与"操作门槛"的矛盾。

| 场景 | 微信群的问题 | 用户心理 |
|------|-------------|----------|
| 发起组局 | "周五观音桥火锅，有人吗？" → 消息被顶走 | 是不是没人理我？ |
| 信息管理 | 刚才还在说火锅，马上有人插嘴说球赛 | 想找刚才那个人？翻聊天记录翻到死 |
| 操作门槛 | 来你这还要选时间、选地点、填标题 | 太累了，算了不发了 |

### 0.2 聚场的解决方案

**核心理念**：我们不试图把用户从微信拉走，而是做一个"外挂"

```
输入端：接住微信群里乱七八糟的文本，用 AI 整理成结构化信息
输出端：生成微信原生卡片，利用视觉优势在群消息流中"抢占地盘"
```

### 0.3 三大核心优势

#### 🎯 响应感 —— 治愈"无人回应的焦虑"

| 旧世界（微信群） | 新世界（聚场） |
|-----------------|---------------|
| 发消息后死一般的寂静 | AI 秒回，0.5s 内开始响应 |
| 运气好有人回表情包 | 流式反馈：文字逐字显示，地图同步飞向目标位置 |

#### 📍 秩序感 —— 把"混乱的流"变成"确定的桩"

| 旧世界（微信群） | 新世界（聚场） |
|-----------------|---------------|
| 信息是流（Flow），瞬间被冲走 | 信息是桩（Pin），24小时内雷打不动 |
| 想找刚才那个人？翻聊天记录 | 橙色 Pin 插在地图上，一目了然 |

#### ⚡ 零门槛 —— 不改变习惯，只提升效率

| 旧世界（填表单） | 新世界（AI 输入栏） |
|-----------------|-------------------|
| 选时间、选地点、填标题 | 在群里怎么说话，在这里就怎么说话 |
| 需要学习新操作 | 直接把群里的乱七八糟复制过来，自动变整齐 |

---

## 1. 商业模式 (MVP)

### 1.1 核心策略：全免费

**MVP 阶段目标**：验证产品价值，积累用户数据

| 功能 | 额度 | 说明 |
|------|------|------|
| AI 创建活动 | 3次/天 | 防止滥用，满足正常需求 |
| 报名参与 | ✅ 无限 | 核心功能 |
| 群聊沟通 | ✅ 无限 | 核心功能 |
| 分享活动 | ✅ 无限 | 增长引擎 |

### 1.2 MVP 砍掉的功能

| 功能 | 砍掉原因 |
|------|----------|
| 付费推广 (Boost/Pin+) | MVP 阶段验证核心价值，不做商业化 |
| 会员订阅 | 用户量不足，订阅制开发复杂 |
| 附近搜索 | 冷启动期无数据，只显示"我相关的"活动 |
| 幽灵锚点 | 运营成本高，MVP 不做 |
| 靠谱度系统 | 复杂度高，MVP 简化 |
| 图片上传 | 开发成本高，MVP 不做 |

---

## 2. 核心功能：CUI 地图副驾

### 2.1 底部导航结构

**3 Tab + AI 输入栏设计**：

```
┌─────────────────────────────────────────────────────────┐
│                      地图区域                           │
│                                                         │
├─────────────────────────────────────────────────────────┤
│  ┌─────────────────────────────────────────────────┐   │
│  │ 🤖  本周想玩什么...                        🎙️ │   │  ← AI 输入栏
│  └─────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────┤
│     [首页]        [消息]        [我的]                  │  ← Tabbar
└─────────────────────────────────────────────────────────┘
```

- **Tab 1**: 首页 - 地图 + AI 输入栏
- **Tab 2**: 消息 - 通知 + 群聊列表
- **Tab 3**: 我的 - 个人中心

### 2.2 AI 输入栏交互

**用户输入**："明晚观音桥打麻将，3缺1"

**AI 副驾反馈 (SSE 流式响应)**：

```
思考态："收到，正在定位观音桥..." (地图同步飞向目标点)
定位态："已锁定观音桥商圈 📍"
结果态：显示创建草稿卡片
```

### 2.3 创建草稿卡片

```
┌─────────────────────────────────────┐
│ 🀄️ 麻将局·3缺1                     │
│ 📍 观音桥 · 明晚 19:00              │
│ 👥 4人 · 🍲 美食                    │
│                                     │
│        [🚀 确认发布]                │
└─────────────────────────────────────┘
```

---

## 3. 地图与 LBS

### 3.1 渲染逻辑

| 类型 | 颜色 | 说明 |
|------|------|------|
| 我的活动 | 🟠 橙色 Pin | 我发布的 + 我参与的 |
| 我的位置 | 🔵 蓝色光点 | 当前用户位置 |

**MVP 简化**：只显示"我相关的"活动，不做附近搜索

### 3.2 重庆地形适配

**必填项**：`location_hint` (位置备注)

**选项**：
- 地面入口
- 地下通道进
- XX楼平台
- 其他：[自定义]

---

## 4. 活动管理

### 4.1 活动状态

| 状态 | 说明 |
|------|------|
| `active` | 进行中，可报名 |
| `completed` | 已成局 |
| `cancelled` | 已取消 |

### 4.2 发起人操作

| 操作 | 条件 | 说明 |
|------|------|------|
| 确认成局 | 活动开始后 | 状态变为 completed |
| 取消活动 | 任何时候 | 状态变为 cancelled |
| 删除活动 | active 且未开始 | 彻底删除 |

### 4.3 参与者操作

| 操作 | 条件 | 说明 |
|------|------|------|
| 报名 | active 状态 | 需绑定手机号 |
| 退出 | 已报名 | 随时可退 |

---

## 5. 临时群聊

### 5.1 基本规则

- 活动创建后立即开启群聊
- 仅支持文字消息
- 活动开始后 24 小时自动归档（只读）

### 5.2 轮询机制

- 前台：每 5-10 秒轮询新消息
- 后台：停止轮询
- 回到前台：立即请求一次 + 恢复轮询

---

## 6. 分享机制

### 6.1 微信原生分享

使用 `onShareAppMessage` 生成分享卡片：

- **标题**：AI 生成的骚气标题（如"🔥 观音桥老火锅，3缺1，速来！"）
- **图片**：腾讯地图静态图（Zoom 16，红色 Marker，5:4 比例）
- **路径**：`/subpackages/activity/detail/index?id=xxx`

### 6.2 单页进入兜底

通过分享卡片进入时，页面栈长度为 1：
- 点击返回 → `wx.switchTab` 跳转首页
- 显示气泡提示："你也来组个局？粘贴文字试试 👇"

---

## 7. 延迟验证

### 7.1 游客权限

| 操作 | 是否需要登录 |
|------|-------------|
| 浏览地图 | ❌ |
| 查看活动详情 | ❌ |
| 尝试 AI 解析 | ❌ |
| 发布活动 | ✅ 需绑定手机号 |
| 报名活动 | ✅ 需绑定手机号 |

### 7.2 手机号绑定

使用微信原生能力：
```html
<button open-type="getPhoneNumber" bindgetphonenumber="onGetPhoneNumber">
  绑定手机号
</button>
```

---

## 8. 页面结构

### 8.1 完整页面清单 (14 页)

| 页面 | 路径 | 类型 |
|-----|------|------|
| 首页 | `pages/home/index` | Tab |
| 消息 | `pages/message/index` | Tab |
| 我的 | `pages/my/index` | Tab |
| 资料编辑 | `pages/my/info-edit/index` | 分包 |
| 我的活动 | `pages/my/activities/index` | 分包 |
| 设置 | `pages/my/settings/index` | 分包 |
| 关于我们 | `pages/my/about/index` | 分包 |
| 活动详情 | `subpackages/activity/detail/index` | 分包 |
| 手动创建 | `subpackages/activity/create/index` | 分包 |
| AI 确认 | `subpackages/activity/confirm/index` | 分包 |
| 群聊 | `pages/chat/index` | 分包 |
| 活动不存在 | `subpackages/activity/not-found/index` | 分包 |
| 用户协议 | `subpackages/legal/user-agreement/index` | 分包 |
| 隐私政策 | `subpackages/legal/privacy-policy/index` | 分包 |

### 8.2 典型用户路径

```
首页(1) → AI确认(2) → 分享成功 = 2 层 ✅
我的(1) → 我的活动(2) → 活动详情(3) → 群聊(4) = 4 层 ✅
我的(1) → 设置(2) → 关于我们(3) → 用户协议(4) = 4 层 ✅
```

---

## 9. 成功指标

### 9.1 业务指标

| 指标 | 目标 |
|------|------|
| 活动成局率 | > 50% |
| 7日留存 | > 20% |
| 分享率 | > 30% |

### 9.2 技术指标

| 指标 | 目标 |
|------|------|
| AI 响应时间 | < 2s |
| 页面加载时间 | < 1s |
| 小程序包体积 | < 2MB |

---

## 附录：术语表

| 术语 | 说明 |
|------|------|
| AI_Input_Bar | 底部 Tabbar 上方悬浮的 AI 入口 |
| CUI_Panel | AI 交互面板，展示思考态、定位态、结果态 |
| Activity_Pin | 地图上的橙色标记点 |
| Location_Hint | 重庆地形适配的位置备注字段 |
| Share_Card | 微信原生分享卡片 |
| Lite_Chat | 活动临时群聊 |
| Delayed_Auth | 延迟验证机制 |
| Custom_Navbar | 自定义导航栏组件 |
